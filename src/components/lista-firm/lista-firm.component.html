<div class="lista-firm-page">
  <div class="container">
    <app-account-header></app-account-header>

    <div class="page-header">
      <h1>Lista Firm</h1>
      <p class="subtitle">Przeglądaj firmy dostępne w bazie danych</p>
    </div>

    <div class="content">
      <!-- Loading indicator -->
      <div *ngIf="isLoading" class="loading">
        <p>Ładowanie danych...</p>
      </div>

      <!-- No data message -->
      <div *ngIf="!isLoading && firmy.length === 0" class="no-data">
        <p>Brak firm do wyświetlenia</p>
      </div>

      <!-- Firms table -->
      <div *ngIf="!isLoading && firmy.length > 0" class="firms-table-container">
        <table class="firms-table">
          <thead>
            <tr>
              <th>Nazwa</th>
              <th>NIP</th>
              <th>PKD główny</th>
              <th>Telefon</th>
              <th>Email</th>
              <th>Strona internetowa</th>
              <th>Status kontaktu</th>
              <th>Data ostatniego kontaktu</th>
              <th>Komentarz</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let firma of firmy">
              <td class="firma-nazwa">{{ firma.nazwa }}</td>
              <td>{{ firma.nip || '-' }}</td>
              <td>{{ firma.pkdGlowny?.kod || '-' }}</td>
              <td>{{ firma.telefon || '-' }}</td>
              <td>{{ firma.email || '-' }}</td>
              <td>
                <a *ngIf="firma.www" [href]="firma.www" target="_blank" rel="noopener noreferrer">{{ firma.www }}</a>
                <span *ngIf="!firma.www">-</span>
              </td>
              <td>{{ firma.statusKontaktu || '-' }}</td>
              <td>
                {{ firma.dataOstatniegoKontaktu ? (firma.dataOstatniegoKontaktu | date:'dd.MM.yyyy') : '-' }}
            </tr>
          
          </tbody>
        </table>

        <!-- Pagination info -->
        <div class="pagination-info">
          <p>
            Wyświetlanie {{ (currentPage || 0) * (pageSize || 10) + 1 }} - 
            {{ Math.min(((currentPage || 0) + 1) * (pageSize || 10), totalElements || 0) }} 
            z {{ totalElements || 0 }} firm
          </p>
        </div>

        <!-- Pagination controls -->
        <div class="pagination-controls">
          <button 
            class="pagination-btn" 
            (click)="onPageChange(currentPage - 1)" 
            [disabled]="currentPage === 0">
            ← Poprzednia
          </button>
          
          <span class="current-page">
            Strona {{ (currentPage || 0) + 1 }} z {{ totalPages || 1 }}
          </span>
          
          <button 
            class="pagination-btn" 
            (click)="onPageChange(currentPage + 1)" 
            [disabled]="(currentPage + 1) * pageSize >= totalElements">
            Następna →
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
